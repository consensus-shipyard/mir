// Code generated by Mir codegen. DO NOT EDIT.

package cryptopbdsl

import (
	dsl "github.com/filecoin-project/mir/pkg/dsl"
	events "github.com/filecoin-project/mir/pkg/pb/cryptopb/events"
	types "github.com/filecoin-project/mir/pkg/pb/cryptopb/types"
	stdtypes "github.com/filecoin-project/mir/stdtypes"
)

// Module-specific dsl functions for emitting events.

func SignRequest[C any](m dsl.Module, destModule stdtypes.ModuleID, data *types.SignedData, context *C) {
	contextID := m.DslHandle().StoreContext(context)

	origin := &types.SignOrigin{
		Module: m.ModuleID(),
		Type:   &types.SignOrigin_Dsl{Dsl: dsl.MirOrigin(contextID)},
	}

	dsl.EmitMirEvent(m, events.SignRequest(destModule, data, origin))
}

func SignResult(m dsl.Module, destModule stdtypes.ModuleID, signature []uint8, origin *types.SignOrigin) {
	dsl.EmitMirEvent(m, events.SignResult(destModule, signature, origin))
}

func VerifySig[C any](m dsl.Module, destModule stdtypes.ModuleID, data *types.SignedData, signature []uint8, nodeId stdtypes.NodeID, context *C) {
	contextID := m.DslHandle().StoreContext(context)

	origin := &types.SigVerOrigin{
		Module: m.ModuleID(),
		Type:   &types.SigVerOrigin_Dsl{Dsl: dsl.MirOrigin(contextID)},
	}

	dsl.EmitMirEvent(m, events.VerifySig(destModule, data, signature, origin, nodeId))
}

func SigVerified(m dsl.Module, destModule stdtypes.ModuleID, origin *types.SigVerOrigin, nodeId stdtypes.NodeID, error error) {
	dsl.EmitMirEvent(m, events.SigVerified(destModule, origin, nodeId, error))
}

func VerifySigs[C any](m dsl.Module, destModule stdtypes.ModuleID, data []*types.SignedData, signatures [][]uint8, nodeIds []stdtypes.NodeID, context *C) {
	contextID := m.DslHandle().StoreContext(context)

	origin := &types.SigVerOrigin{
		Module: m.ModuleID(),
		Type:   &types.SigVerOrigin_Dsl{Dsl: dsl.MirOrigin(contextID)},
	}

	dsl.EmitMirEvent(m, events.VerifySigs(destModule, data, signatures, origin, nodeIds))
}

func SigsVerified(m dsl.Module, destModule stdtypes.ModuleID, origin *types.SigVerOrigin, nodeIds []stdtypes.NodeID, errors []error, allOk bool) {
	dsl.EmitMirEvent(m, events.SigsVerified(destModule, origin, nodeIds, errors, allOk))
}
